var pitchchanging=!0,zoomThreshold=16.5,zoomStart=15.5,pitchto=55,pitchfrom=20,mapdisab=!1,openedmenu=-1,openlat="46.1662169959036",openlng="8.7923381075233",lang="en",theaters_flag="Theaters",locations_flag="Other Locations",button_flag="Discover more",directions_flag="Get directions",langpattern=/l=it/;showOtherLocations=function(){$(".theaters-inner").slideUp(300,function(){$(".theathers-menu").removeClass("sec-active"),$(".others-menu").addClass("sec-active"),$(".locations-inner").slideDown(300)})},showTheaters=function(){$(".locations-inner").slideUp(300,function(){$(".theathers-menu").addClass("sec-active"),$(".others-menu").removeClass("sec-active"),$(".theaters-inner").slideDown(300)})},initMap=function(){langpattern.test(window.location.href)&&(lang="it",theaters_flag="Sale",locations_flag="Altre location",button_flag="Scopri di pi\xf9",directions_flag="Ottieni indicazioni"),821>$(window).width()&&(pitchfrom=10,pitchto=30,zoomThreshold=16,zoomStart=15.2,openlat="46.16893647528967",openlng="8.795653317766366"),$.ajax({url:"./data/locations_"+lang+".json",dataType:"json",type:"GET",success:function(a){for(x=0,locs=a.locations.length;x<locs;x++)gID=x,gTitle=a.locations[x].title,gSubtitle=a.locations[x].subtitle,gLat=a.locations[x].latitude,gLng=a.locations[x].longitude,gAddr=a.locations[x].address,gUrl=a.locations[x].linkurl,gImg=a.locations[x].picture,"undefined"!=typeof gSubtitle&&(gSubtitle=gSubtitle.replace(/. Accessibility:/,".<br/><br/>Accessibility:")),0==x&&$('<div class="card"><div class="card-header card-header-black sec-active theathers-menu"><h5 class="mb-0"><button class="btn btn-link" type="button" onclick="javascript:showTheaters()">'+theaters_flag+'</button></h5></div></div><div class="theaters-inner"></div>').appendTo($("#accordionMenu")),x<10&&($('<span class="texts" title="'+gTitle+'" data-href="'+gAddr+'" data-link="'+gUrl+'" data-image="'+gImg+'" id="txt-'+gID+'">'+gSubtitle+"</span>").appendTo($("body")),$('<div class="card theaters"><div class="card-header" id="a-'+gID+'"><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse-'+gID+'" aria-expanded="false" aria-controls="collapse-'+gID+'" onclick="javascript:moveMap('+gLat+", "+gLng+", "+gID+')">'+gTitle+'</button></h5></div><div id="collapse-'+gID+'" class="collapse" aria-labelledby="a-'+gID+'" data-parent="#accordionMenu"><div class="card-body"></div></div></div>').appendTo($(".theaters-inner"))),9==x&&$('<div class="card"><div class="card-header card-header-black others-menu"><h5 class="mb-0"><button class="btn btn-link" type="button" onclick="javascript:showOtherLocations()">'+locations_flag+'</button></h5></div></div><div class="locations-inner"></div>').appendTo($("#accordionMenu")),x>9&&x<22&&($('<span class="texts" title="'+gTitle+'" data-href="'+gAddr+'" data-link="'+gUrl+'" data-image="'+gImg+'" id="txt-'+gID+'">'+gSubtitle+"</span>").appendTo($("body")),$('<div class="card other-locations"><div class="card-header" id="a-'+gID+'"><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse-'+gID+'" aria-expanded="false" aria-controls="collapse-'+gID+'" onclick="javascript:moveMap('+gLat+", "+gLng+", "+gID+')">'+gTitle+'</button></h5></div><div id="collapse-'+gID+'" class="collapse" aria-labelledby="a-'+gID+'" data-parent="#accordionMenu"><div class="card-body"></div></div></div>').appendTo($(".locations-inner")))}}),$(".hamburger").on("click",function(){$(".card").removeClass("active"),$(this).toggleClass("is-active"),$("#accordionMenu").toggleClass("is-opened"),$(".mobile-desc").removeClass("d-inline")}),mapdisab||mapBoxLoad()},mapBoxLoad=function(){mapboxgl.accessToken="pk.eyJ1IjoiZnVyZ2kiLCJhIjoiY2wxbm10OHFzMHZ4aTNla3EyZWdsYmY0eCJ9.O2qIBQLtY26c2O16TZacTA";let a=new mapboxgl.Map({container:"map",style:"mapbox://styles/furgi/cl1nmyep2003314lz7l7tvyek",center:[8.745500712530264,46.168178223924684],zoom:13,minZoom:10,pitch:pitchfrom,bearing:0});a.on("load",()=>{a.easeTo({center:[openlng,openlat],bearing:-44,duration:3e3,zoom:zoomStart}),pitchchanging=!0,a.setPaintProperty("3D-extrusions","fill-extrusion-color",["match",["get","LFFtype"],"Theater","#ffdd00","#e2e2e2"]),a.addSource("festivallocations",{type:"vector",data:"mapbox://furgi.cl1ozoljm0bow27qp7c2n8y4y-6ikd2"}),a.on("click",e=>{let f=a.queryRenderedFeatures(e.point),h=["type","properties","id","layer","sourceLayer"],g=f.map(b=>{let a={};return h.forEach(c=>{a[c]=b[c]}),a}),b=g[0];if(void 0!==b&&"3D-extrusions"==(layerCheck=b.layer).id){if(spanObj=$("#txt-"+(clickedid=b.properties.LFFid)),clickedid<10&&clickedid!=openedmenu){showTheaters();let c=$("#a-"+clickedid);c.length>0&&c.find("button").addClass("mobile-clicked").trigger("click")}if(clickedid>=10&&clickedid!=openedmenu){showOtherLocations();let d=$("#a-"+clickedid);d.length>0&&d.find("button").addClass("mobile-clicked").trigger("click"),openedmenu=clickedid}}}),a.on("mousemove",c=>{let d=a.queryRenderedFeatures(c.point),f=["type","properties","id","layer","sourceLayer"],e=d.map(b=>{let a={};return f.forEach(c=>{a[c]=b[c]}),a}),b=e[0];void 0!==b&&("3D-extrusions"==(layerCheck=b.layer).id?a.getCanvas().style.cursor="pointer":a.getCanvas().style.cursor="")}),$("img.in").on("click",function(){gZ=a.getZoom()+.5,a.easeTo({duration:900,zoom:gZ})}),$("img.out").on("click",function(){gZ=a.getZoom()-.5,a.easeTo({duration:900,zoom:gZ})}),moveMap=function(f,g,b){$(".mapboxgl-popup").remove();let h=!1;if($("#a-"+b).find("button").hasClass("mobile-clicked")&&(h=!0),$("#a-"+b).find("button").removeClass("mobile-clicked"),b!=openedmenu||h||($("#accordionMenu").toggleClass("is-opened"),$(".hamburger").toggleClass("is-active")),b==openedmenu){gtMapLatlng=f+","+g,aObj=$("#a-"+b),popTitle=spanObj.attr("title"),popAddress=spanObj.attr("data-href"),popLink=spanObj.attr("data-link"),popImage=spanObj.attr("data-image"),popDesc=spanObj.html();let d="";"undefined"!=popImage&&(d='<a class="mimg" style="background-image:url(./images/'+popImage+')"></a>'),"undefined"!=popDesc&&(d+="<p>"+popDesc+"</p>"),"undefined"!=popLink&&(d=d+'<a href="'+popLink+'" class="ext-url" target="_blank">'+button_flag+"</a>"),"undefined"!=popAddress&&(d=d+'<a href="https://www.google.com/maps/dir/?api=1&destination='+encodeURIComponent(popAddress)+'" target="_blank"><img class="dir" src="./images/directions_square.svg" alt="'+directions_flag+'" title="'+directions_flag+'" /></a>'),$(".mobile-desc").html("<h5>"+popTitle+"</h5>"+d).addClass("d-inline")}if(b!=openedmenu){openedmenu=b,h||($("#accordionMenu").toggleClass("is-opened"),$(".hamburger").toggleClass("is-active")),$(".mobile-desc").removeClass("d-inline"),disab=!1;{$("div.marker-pin").remove();let e=document.createElement("div");e.className="marker-pin",e.style.backgroundImage="url(./images/LFF-pin.svg)",e.style.width="18px",e.style.height="18px",e.style.backgroundSize="100%",new mapboxgl.Marker(e).setLngLat([g,f]).addTo(a),a.off("zoom",()=>{}),a.easeTo({center:[g,f],duration:1200,zoom:zoomThreshold,pitch:pitchto,offset:[0,-90]})}spanObj=$("#txt-"+b),gtMapLatlng=f+","+g,aObj=$("#a-"+b),popTitle=spanObj.attr("title"),popAddress=spanObj.attr("data-href"),popLink=spanObj.attr("data-link"),popImage=spanObj.attr("data-image"),popDesc=spanObj.html(),$(".card").removeClass("active");let c="";"undefined"!=popImage&&(c='<a class="mimg" style="background-image:url(./images/'+popImage+')"></a>'),"undefined"!=popDesc&&(c+="<p>"+popDesc+"</p>"),"undefined"!=popLink&&(c=c+'<a href="'+popLink+'" class="ext-url" target="_blank">'+button_flag+"</a>"),"undefined"!=popAddress&&(c=c+'<a href="https://www.google.com/maps/dir/?api=1&destination='+encodeURIComponent(popAddress)+'" target="_blank"><img class="dir" src="./images/directions_square.svg" alt="'+directions_flag+'" title="'+directions_flag+'" /></a>'),aObj.closest(".card").addClass("active");aObj.parent().find(".card-body").html(c),$(".mobile-desc").html("<h5>"+popTitle+"</h5>"+c).addClass("d-inline")}},a.loadImage("./images/LFF-info.png",(b,c)=>{if(b)throw b;a.addImage("custom-marker",c)}),a.loadImage("./images/LFF-bike.png",(b,c)=>{if(b)throw b;a.addImage("bike-marker",c)}),a.addSource("points",{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[8.796647722205217,46.16965582334466]},properties:{title:"Info Point"}},{type:"Feature",geometry:{type:"Point",coordinates:[8.789048104484467,46.164011673039354]},properties:{title:"Info Point"}},{type:"Feature",geometry:{type:"Point",coordinates:[8.79472956831609,46.169084041321966]},properties:{title:"Info Point"}},{type:"Feature",geometry:{type:"Point",coordinates:[8.79586599922836,46.16942704633847]},properties:{title:"Festival Center"}}]}}),a.addSource("bike",{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[8.7983530469542,46.16978553664626]},properties:{title:"Bike Rental"}}]}}),a.addLayer({id:"points",type:"symbol",source:"points",layout:{"icon-image":"custom-marker","text-field":["get","title"],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-offset":[-2,0],"text-anchor":"right","text-size":10},paint:{"text-color":"#ffffff"}}),a.addLayer({id:"bike",type:"symbol",source:"bike",layout:{"icon-image":"bike-marker","text-field":["get","title"],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-offset":[-2,0],"text-anchor":"right","text-size":10},paint:{"text-color":"#ffffff"}})})}